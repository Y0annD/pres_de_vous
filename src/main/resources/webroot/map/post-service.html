
<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/iron-ajax/iron-ajax.html">

<dom-module id="post-service">
    <style>
        :host {
            display: none;
        }
    </style>
    <template>
        <iron-ajax
            auto
            url="{{computeJsonUrl(prov, lat, lng)}}"
            handle-as="json"
            on-response="postsLoaded">
        </iron-ajax>
    </template>
    <script>
        Polymer({
            is: 'post-service',

            properties: {
				fakeApi: {
					type: String,
					value: ''
				},
                posts: {
                    type: Array,
                    value: [],
                    notify: true
                },
				prov: String,
                lat: Number,
                lng: Number
            },

            computeJsonUrl: function(provider, latitude, longitude) {
				if (this.fakeApi)
					return this.fakeApi;
				return '../'+provider+'/'+latitude+'/'+longitude;
            },

            postsLoaded: function(request) {
                // Make a copy of the loaded data
                this.posts = request.detail.response;
            },

            /**
             * Update the service with the current favorite value.
             * (Two-way data binding updates the favorite value
             * stored locally.) If this was a real service, this
             * method would do something useful.
             *
             * @method setFavorite
             * @param uid {Number} Unique ID for post.
             * @param isFavorite {Boolean} True if the user marked this post as a favorite.
             */
            setFavorite: function(uid, isFavorite) {
                // no service backend, just log the change
            }
        });
    </script>
</dom-module>