
<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/google-map/google-map.html">

<link rel="import" href="post-service.html">
<link rel="import" href="post-card.html">
<link rel="import" href="search-box.html">

<dom-module id="pic-map">
    <style>
        :host {
        }
		
		#controlsToggle {
		  position: absolute;
		  left: 10%;
		  bottom: 10%;
		}
    </style>
    <template>
		<!-- POUR SIMU OFFLINE (fake API) : Ajouter fake-api="path/to/static-data.json" dans le tag post-service désiré (le format du JSON doit être compatible). -->
		
        <!-- <post-service prov="google" lat="{{lat}}" lng="{{lng}}" posts="{{posts.google}}"></post-service> -->
        <!-- <post-service prov="twitter" lat="{{lat}}" lng="{{lng}}" posts="{{posts.twitter}}"></post-service> -->
        <post-service fake-api="fake-api.json" prov="insta" lat="{{lat}}" lng="{{lng}}" posts="{{posts.insta}}"></post-service>
		
        <google-map disable-default-ui latitude="{{lat}}" longitude="{{lng}}" zoom="15" language="fr">
			
            <!-- <template is="dom-repeat" items="{{posts.google.results}}">
                <google-map-marker
					icon="img/gmark-small.png"
					latitude="{{item.location.latitude}}"
					longitude="{{item.location.longitude}}"
					title="{{item.author.username}}"
					language="fr">
					
                    <post-card
                        favorite="{{item.favorite}}"
                        on-favorite-tap="{{handleFavorite}}"
                        hidden?="{{show == 'favorites' && !post.favorite}}">
						
                        <img class="round" src="{{item.author.profile_picture}}" width="70" height="70">
                        <h2>{{item.author.username}}</h2>
                        <p>{{item.location.name}}}}</p><br /><br />
						<img src="{{item.image.url}}" alt="{{item.author.username}}" />
						<a href="{{item.link}}" title="{{item.location.name}}">{{item.link}}</a>
						
                    </post-card>
					
                </google-map-marker>
            </template> -->
			
            <!-- <template is="dom-repeat" items="{{posts.twitter.results}}">
                <google-map-marker
					icon="img/tmark-small.png"
					latitude="{{item.location.latitude}}"
					longitude="{{item.location.longitude}}"
					title="{{item.text}}"
					language="fr">
						
					<post-card
						favorite="{{item.favorite}}"
						on-favorite-tap="{{handleFavorite}}"
						hidden?="{{show == 'favorites' && !post.favorite}}">
						
						<img class="round" src="{{item.author.profile_picture}}" width="70" height="70">
						<h2>{{item.author.username}}</h2>
						<p>{{item.text}}</p><br /><br />
						<img src="{{item.}}" alt="{{item.text}}" />
						<a href="{{item.link}}" title="{{item.text}}">{{item.link}}</a>
							
					</post-card>
					
                </google-map-marker>
            </template> -->
			
            <template is="dom-repeat" items="{{posts.insta.results}}">
                <google-map-marker
					icon="img/imark-small.png"
					latitude="{{item.location.latitude}}"
					longitude="{{item.location.longitude}}"
					title="{{item.location.name}}"
					language="fr">
					
                    <post-card
                        favorite="{{item.favorite}}"
                        on-favorite-tap="{{handleFavorite}}"
                        hidden?="{{show == 'favorites' && !post.favorite}}">
						
                        <img class="round" src="{{item.author.profile_picture}}" width="70" height="70">
                        <h2>{{item.author.username}}</h2>
                        <p>{{item.location.name}}}}</p><br /><br />
						<img src="{{item.image.url}}" alt="{{item.location.name}}" />
						<a href="{{item.link}}" title="{{item.location.name}}">{{item.link}}</a>
						
                    </post-card>
					
                </google-map-marker>
            </template>
			
        </google-map>
		
		<button id="controlsToggle" on-click="togglePlace">Go ENIBar</button>

        <!-- <div id="search">
            <iron-icon icon="icons:search"></iron-icon>
            <input placeholder="Emplacement">
        </div> -->
		
		<search-box language="fr" lat="{{lat}}" lng="{{lng}}"></search-box>
    </template>
    <script>
        Polymer({
            is: 'pic-map',

            properties: {
                posts: {
                    type: Object,
                    value: {}
                },
                lat: {
                    type: Number,
                    value: 0,
					notify: true,
					reflectToAttribute: true
                },
                lng: {
                    type: Number,
                    value: 0,
					notify: true,
					reflectToAttribute: true
                }
            },
			
			observers: [
				'geoChanged(lat, lng)'
			],
			
			geoChanged: function(lat, lng) {
				document.querySelector('google-map').resize();
			},
			
			togglePlace: function() {
				document.querySelector('google-map').clear();
				this.lat = 48.3612161;
				this.lng = -4.5661822;
			},
        });
    </script>
</dom-module>
